const postURL="/web.auth",queries=function(c){if(""==c)return{};for(var a,d={},b=0;b<c.length;++b)a=c[b].split("=",2),d[a[0]]=1==a.length?"":decodeURIComponent(a[1].replace(/\+/g," "));return d}(window.location.search.substr(1).split("&"));document.getElementsByClassName("close1")[0].style.display="none";function shakeError1(a,b,c,d){$(b).css({color:d}),$(c).css({color:d}),$(a).effect("shake")}function resetColor(a,b){$(b).css({color:""}),$(a).css({color:""}),$(a).attr("placeholder","")}function testEmail(a){if(1!=(a.match(/@/g)||[]).length||5>a.length)return"NO";var b=a.split("@");if("pdedu.org"!=b[1]&&"peddie.institute"!=b[1]||""==b[0])return"NO";var c=punycode.toASCII(b[1]),d=punycode.toASCII(b[0]);return /^[a-z0-9]+$/.test(d)?(c=d+"@"+c,c):"NO"}$(document).ready(function(){$("#usr_password").keypress(function(){resetColor("#usr_password","#usr_password_icon"),$("#login").prop("disabled",!1)}),$("#usr_email").keypress(function(){resetColor("#usr_email","#usr_email_icon"),$(".submit1").text("GET PIN"),$(".button1").attr("class","button1").prop("disabled",!1)})});function LOGIN_TF(a){if(2<a.length){var b=a.split(";");if(setCookie("ev3wIJe333",b[0],0,"/"),null!=queries["return"]&&""!=queries["return"]){var c=Base64.decode(queries["return"]);c.includes("/web.auth")?window.location.replace("https://peddie.institute/"):"http://"==c.substring(0,7)||"https://"==c.substring(0,8)?null!=b[1]&&""!=b[1]&&null!=queries.t&&""!=queries.t&&null!=queries.t.match(/^[0-9]+$/)?window.location.replace("https:"+c.substr(c.indexOf(":")+1)+"?t="+queries.t+"&token="+b[1]):window.location.replace("https:"+c.substr(c.indexOf(":")+1)):window.location.replace("https://peddie.institute"+c)}else window.location.replace("https://peddie.institute/")}else"ER"==a?(document.getElementById("usr_password").value="",shakeError1("#usr_password_group","#usr_password_icon","#usr_password","#ffe819"),document.getElementById("usr_password").disabled=!1,console.log("ERROR: Please check your Access Code!")):(document.getElementById("usr_email").placeholder="TOO_MANY_FAILED_ATTEMPTS",document.getElementById("usr_password").placeholder="NEW_CODE_REQUIRED",shakeError1("#usr_email_group","#usr_email_icon","#usr_email","#FF0000"),shakeError1("#usr_password_group","#usr_password_icon","#usr_password","#FF0000"),console.log("ERROR: NEW OTP REQUIRED."),document.getElementById("usr_password").value="",document.getElementById("usr_email").value="",document.getElementById("usr_email").disabled=!1)}function loginPost(a){$.ajax({data:a,url:postURL,method:"POST",success:function(a){LOGIN_TF(a)}})}function sendPost_BTN(a){document.getElementById("usr_email").disabled?"ERRRR"==a?(shakeError1("#usr_email_group","#usr_email_icon","#usr_email","#FF0000"),document.getElementById("usr_email").value="",document.getElementById("usr_email").disabled=!1,document.querySelector(".button1").classList.add("finished2"),console.log("ERROR: Please check your Email!")):(document.getElementsByClassName("button1")[0].classList.add("finished1"),document.getElementById("usr_password").value="",document.getElementById("usr_password").disabled=!1):(document.getElementById("usr_email").value="",console.log("ERROR: Please check your Email!"))}function sendPost(a){$.ajax({data:a,url:postURL,method:"POST",success:function(a){sendPost_BTN(a.substring(0,5))}})}const button=document.querySelector(".button1"),submit=document.querySelector(".submit1");function toggleClass(){this.classList.toggle("active1")}function addClass(){document.getElementById("usr_email").disabled=!0;var a=testEmail(document.getElementById("usr_email").value.toString().toLowerCase());"NO"==a?(document.getElementById("usr_email").value="",document.getElementById("usr_email").disabled=!1,this.classList.add("finished2"),shakeError1("#usr_email_group","#usr_email_icon","#usr_email","#FF0000"),console.log("ERROR: Please check your Email!")):sendPost("ACC="+a)}button.addEventListener("click",toggleClass),button.addEventListener("transitionend",toggleClass),button.addEventListener("transitionend",addClass),$("#login").click(function(a){a.preventDefault(),document.getElementById("usr_password").disabled=!0,document.getElementById("login").disabled=!0;var b=testEmail(document.getElementById("usr_email").value.toString().toLowerCase()),c=document.getElementById("usr_password").value;"NO"!=b&&document.getElementById("usr_email").disabled?5==c.length&&null!=c.match(/^[0-9]+$/)?(null!=queries.t&&""!=queries.t&&null!=queries["return"]&&""!=queries["return"]&&null!=queries.t.match(/^[0-9]+$/)&&(c+="&t="+queries.t+"&return="+queries["return"]),loginPost("usr="+b+"&pwd="+c)):(document.getElementById("usr_password").value="",shakeError1("#usr_password_group","#usr_password_icon","#usr_password","#ffe819"),document.getElementById("usr_password").disabled=!1,console.log("ERROR: Please check your Access Code!")):(document.getElementById("usr_password").value="",document.getElementById("usr_email").value="",document.getElementById("usr_email").disabled=!1,shakeError1("#usr_email_group","#usr_email_icon","#usr_email","#FF0000"),shakeError1("#usr_password_group","#usr_password_icon","#usr_password","#FF0000"),console.log("ERROR: Please check your Email and Access Code!"))});
